<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Read Gmail in Emacs with notmuch and lieer | Cash Prokop-Weaver</title>
<meta name=keywords content>
<meta name=description content="This is a guide to setting up access to email from a Gmail account (eg: @gmail.com) within Emacs (Doom Emacs) using notmuch and lieer.
You may have to complete additional steps if you are not using doom emacs or if your set-up differs from mine in other ways.
Prerequisites Please be sure you&rsquo;ve completed these steps before continuing:
Required Software   lieer
git clone https://github.com/gauteh/lieer.git cd lieer pip3 install -r requirements.">
<meta name=author content>
<link rel=canonical href=http://cashpw.com/posts/ada68d10-cec8-4af1-903d-29dfa71d2343/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.3dd5fc0c6b7c20598373460d5ac7a381c5e529b01751044773f81809e440dad0.css integrity="sha256-PdX8DGt8IFmDc0YNWsejgcXlKbAXUQRHc/gYCeRA2tA=" rel="preload stylesheet" as=style>
<link rel=icon href=http://cashpw.com/favicon.ico>
<link rel=apple-touch-icon href=http://cashpw.com/apple-touch-icon.png>
<meta name=twitter:title content="Read Gmail in Emacs with notmuch and lieer | Cash Prokop-Weaver">
<meta name=twitter:description content="This is a guide to setting up access to email from a Gmail account (eg: @gmail.com) within Emacs (Doom Emacs) using notmuch and lieer.
You may have to complete additional steps if you are not using doom emacs or if your set-up differs from mine in other ways.
Prerequisites Please be sure you&rsquo;ve completed these steps before continuing:
Required Software   lieer
git clone https://github.com/gauteh/lieer.git cd lieer pip3 install -r requirements.">
<meta property="og:title" content="Read Gmail in Emacs with notmuch and lieer | Cash Prokop-Weaver">
<meta property="og:description" content="This is a guide to setting up access to email from a Gmail account (eg: @gmail.com) within Emacs (Doom Emacs) using notmuch and lieer.
You may have to complete additional steps if you are not using doom emacs or if your set-up differs from mine in other ways.
Prerequisites Please be sure you&rsquo;ve completed these steps before continuing:
Required Software   lieer
git clone https://github.com/gauteh/lieer.git cd lieer pip3 install -r requirements.">
<meta property="og:type" content="article">
<meta property="og:url" content="http://cashpw.com/posts/ada68d10-cec8-4af1-903d-29dfa71d2343/">
<meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-12-27T19:56:00-08:00">
<meta property="article:modified_time" content="2022-11-04T15:15:44-07:00">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://cashpw.com/posts/"},{"@type":"ListItem","position":2,"name":"Read Gmail in Emacs with notmuch and lieer","item":"http://cashpw.com/posts/ada68d10-cec8-4af1-903d-29dfa71d2343/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Read Gmail in Emacs with notmuch and lieer | Cash Prokop-Weaver","name":"Read Gmail in Emacs with notmuch and lieer","description":"This is a guide to setting up access to email from a Gmail account (eg: @gmail.com) within Emacs (Doom Emacs) using notmuch and lieer.\nYou may have to complete additional steps if you are not using doom emacs or if your set-up differs from mine in other ways.\nPrerequisites Please be sure you\u0026rsquo;ve completed these steps before continuing:\nRequired Software   lieer\ngit clone https://github.com/gauteh/lieer.git cd lieer pip3 install -r requirements.","keywords":[],"wordCount":"571","inLanguage":"en","datePublished":"2021-12-27T19:56:00-08:00","dateModified":"2022-11-04T15:15:44-07:00","author":[{"@type":"Person","name":"Cash Weaver"}],"mainEntityOfPage":{"@type":"WebPage","@id":"http://cashpw.com/posts/ada68d10-cec8-4af1-903d-29dfa71d2343/"},"publisher":{"@type":"Organization","name":"Cash Prokop-Weaver","logo":{"@type":"ImageObject","url":"http://cashpw.com/favicon.ico"}}}</script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:!0,processEnvironments:!0,macros:{bigo:["{\\href{/posts/big_o_notation}{O}}(#1)",1],littleo:["{\\href{/posts/little_o_notation}{o}}(#1)",1],bigtheta:["{\\href{/posts/big_theta_notation}{\\Theta}}(#1)",1],bigomega:["{\\href{/posts/big_omega_notation}{\\Omega}}(#1)",1]}},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}},window.addEventListener('load',a=>{document.querySelectorAll("mjx-container").forEach(function(a){a.parentElement.classList+='has-jax'})})</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
</head>
<body class="type-posts kind-page layout-" id=top><script data-no-instant>function switchTheme(a){switch(a){case'light':document.body.classList.remove('dark');break;case'dark':document.body.classList.add('dark');break;default:window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(a){switchTheme(a),localStorage.setItem("pref-theme",a)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=a=>{a?setPrefTheme('light'):setPrefTheme('dark')},window.addEventListener('toggle-theme',function(){const a=isDarkTheme();for(const b in toggleThemeCallbacks)toggleThemeCallbacks[b](a)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent('toggle-theme'))}</script>
<script>(function(){const b='auto',a=getPrefTheme(),c=a||b;switchTheme(c)})()</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=http://cashpw.com/ accesskey=h title="Cash Prokop-Weaver (Alt + H)">Cash Prokop-Weaver</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=http://cashpw.com/archives/ title=Archives>Archives
</a>
</li>
<li>
<a href=http://cashpw.com/search/ title="Search (Alt + /)" data-no-instant accesskey=/>Search
</a>
</li>
<li>
<a href=http://cashpw.com/tags/ title=Tags>Tags
</a>
</li>
</ul>
</nav>
</header>
<main class="main post">
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Read Gmail in Emacs with notmuch and lieer
</h1>
<div class=post-meta><span title="2021-12-27 19:56:00 -0800 -0800">2021-12-27</span>&nbsp;·&nbsp;<span style=margin-right:.5ch>Updated:</span><span title="2022-11-04 15:15:44 -0700 -0700">2022-11-04</span>&nbsp;·&nbsp;3 min
</div>
<div class=post-meta><a href=https://github.com/cashpw/notes/edit/main/read_gmail_in_emacs_with_notmuch_and_lieer.org rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
<div class="post-meta post-references"></div><div class="post-meta post-stars"></div>
</header> <div class="toc side right">
<details open>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#prerequisites aria-label=Prerequisites>Prerequisites</a><ul>
<li>
<a href=#required-software aria-label="Required Software">Required Software</a></li>
<li>
<a href=#create-an-oauth2-client-id aria-label="Create an OAuth2 Client ID">Create an OAuth2 Client ID</a></li>
<li>
<a href=#enable-notmuch-within-emacs aria-label="Enable notmuch within emacs">Enable <code>notmuch</code> within <code>emacs</code></a></li></ul>
</li>
<li>
<a href=#configure-notmuch aria-label="Configure notmuch">Configure <code>notmuch</code></a></li>
<li>
<a href=#configure-lieer aria-label="Configure lieer">Configure <code>lieer</code></a></li>
<li>
<a href=#set-up-cronjob-to-sync-email aria-label="Set up Cronjob to Sync Email">Set up Cronjob to Sync Email</a></li>
<li>
<a href=#configure-notmuch-within-emacs--optional aria-label="Configure notmuch within emacs (optional)">Configure <code>notmuch</code> within <code>emacs</code> (optional)</a></li>
<li>
<a href=#done aria-label=Done!>Done!</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content>
<p>This is a guide to setting up access to email from a Gmail account (eg: @gmail.com) within <a href=/posts/5ad4f07c-b06a-4dbf-afa5-176f25b0ded7/>Emacs</a> (<a href=/posts/doom_emacs/>Doom Emacs</a>) using <a href=https://notmuchmail.org/><code>notmuch</code></a> and <a href=https://github.com/gauteh/lieer><code>lieer</code></a>.</p>
<p>You may have to complete additional steps if you are not using <a href=https://github.com/hlissner/doom-emacs><code>doom emacs</code></a> or if your set-up differs from mine in other ways.</p>
<h2 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>¶</a></h2>
<p>Please be sure you&rsquo;ve completed these steps before continuing:</p>
<h3 id=required-software>Required Software<a hidden class=anchor aria-hidden=true href=#required-software>¶</a></h3>
<ol>
<li>
<p><code>lieer</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>git clone https://github.com/gauteh/lieer.git
cd lieer
pip3 install -r requirements.txt
</code></pre></div></li>
<li>
<p><code>notmuch</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo apt install notmuch
</code></pre></div></li>
</ol>
<h3 id=create-an-oauth2-client-id>Create an OAuth2 Client ID<a hidden class=anchor aria-hidden=true href=#create-an-oauth2-client-id>¶</a></h3>
<ol>
<li>Please refer to: <a href=/posts/486b286b-8806-4282-af4e-cfbac4fb0990/>Create an OAuth2 Client ID</a></li>
<li>Ensure GMail APIs are enabled for this Client ID.</li>
<li>Download the JSON format of this key.</li>
</ol>
<h3 id=enable-notmuch-within-emacs>Enable <code>notmuch</code> within <code>emacs</code><a hidden class=anchor aria-hidden=true href=#enable-notmuch-within-emacs>¶</a></h3>
<p>This is written for those using <a href=https://github.com/hlissner/doom-emacs><code>doom emacs</code></a>. Those using other flavors of <code>emacs</code> will need to enable <code>notmuch</code> on their own.</p>
<ol>
<li>Enable <code>notmuch</code> by uncommenting <code>notmuch</code> within <code>init.el</code> beneath the <code>:email</code> header.</li>
<li>Run <code>doom sync</code> in your shell.</li>
<li>Reload <code>doom emacs</code> by either killing <code>emacs</code> and restarting, or by running <code>doom/reload</code> (<code>SPC : doom/reload</code> or <code>SPC h r r</code>).</li>
</ol>
<h2 id=configure-notmuch>Configure <code>notmuch</code><a hidden class=anchor aria-hidden=true href=#configure-notmuch>¶</a></h2>
<p>These steps are pulled from <code>notmuch</code>&rsquo;s own <a href=https://notmuchmail.org/getting-started/>documentation</a>.</p>
<ol>
<li>
<p>Run <code>notmuch</code> in your shell to create <code>~/.notmuch-config</code>.</p>
</li>
<li>
<p>Perform initial indexing:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e># Create a directory to house your mail if you don&#39;t already have one.</span>
mkdir -p /path/to/your/mail/directory

cd /path/to/your/mail/directory
notmuch new
</code></pre></div><p>You should see something like:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>Found 0 total files (that&#39;s not much mail)
No new mail.
</code></pre></div></li>
</ol>
<h2 id=configure-lieer>Configure <code>lieer</code><a hidden class=anchor aria-hidden=true href=#configure-lieer>¶</a></h2>
<p>These steps are pulled from <code>lieer</code>&rsquo;s own <a href=https://github.com/gauteh/lieer#usage>documentation</a>.</p>
<ol>
<li>
<p>Make a directory for the lieer storage and state files (local repository).</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cd /path/to/your/mail/directory
mkdir &lt;you&gt;.gmail
cd you.gmail
</code></pre></div></li>
<li>
<p>Update your <code>~/.notmuch-config</code> to ignore <code>json</code>, <code>lock</code>, and <code>bak</code> files by updating the <code>[new]</code> section to read:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>[new]
tags=new
ignore=/.*[.](json|lock|bak)$/
</code></pre></div></li>
<li>
<p>Initialize your mail storage.</p>
<p>This command will open a new tab in your browser. We need to run this command once before we can specify our own credentials. Feel free to close the tab as soon as it opens as we&rsquo;ll be swapping the default client id with our own in the next steps.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e># From within /path/to/your/mail/directory/&lt;you&gt;.gmail</span>
/path/to/lieer/gmi init &lt;you&gt;@gmail.com
</code></pre></div></li>
<li>
<p>Cancel out (<code>CTRL-C</code>).</p>
<p>You should see a message similar to:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>init: repository is set up, but authorization failed. re-run &#39;gmi auth&#39; with proper parameters to complete authorization
</code></pre></div></li>
<li>
<p>Set your credentials.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e># From within /path/to/your/mail/directory/&lt;you&gt;.gmail</span>
/path/to/lieer/gmi auth <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --credentials<span style=color:#f92672>=</span>/path/to/your/OAuth2/client/id.json

<span style=color:#75715e># Or, if you&#39;re working remotely (SSHing into your workstation, etc)</span>
/path/to/lieer/gmi <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --noauth_local_webserver <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  auth <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  --credentials<span style=color:#f92672>=</span>/path/to/your/OAuth2/client/id.json
</code></pre></div><p>Open the link and authenticate using your <code>@gmail.com</code> account. Copy the code and paste it back into the running <code>gmi</code> command. You should see a message like:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>Authentication successful.
credentials stored in /path/to/your/mail/directory/you.gmail/.credentials.gmailieer.json
</code></pre></div></li>
<li>
<p>Sync your email.</p>
<p>This step may take a long time. My initial sync of 90k emails took 56 real-time minutes.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e># From within /path/to/your/mail/directory/&lt;you&gt;.gmail</span>
/path/to/lieer/gmi sync
</code></pre></div></li>
</ol>
<h2 id=set-up-cronjob-to-sync-email>Set up Cronjob to Sync Email<a hidden class=anchor aria-hidden=true href=#set-up-cronjob-to-sync-email>¶</a></h2>
<p>You could also use a <code>systemd</code> timer for this.</p>
<ol>
<li>
<p>Create a new shell script to sync your email. Remember to <code>chmod 777</code>!</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e>#!/bin/bash
</span><span style=color:#75715e></span>
cd /path/to/your/mail/directory/you.gmail
/path/to/lieer/gmi sync
</code></pre></div></li>
<li>
<p>Configure the cronjob with <code>crontab -e</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text># Sync email with lieer every three minutes.
*/3 * * * * bash /path/to/your/script/sync_email.sh
</code></pre></div></li>
</ol>
<h2 id=configure-notmuch-within-emacs--optional>Configure <code>notmuch</code> within <code>emacs</code> (optional)<a hidden class=anchor aria-hidden=true href=#configure-notmuch-within-emacs--optional>¶</a></h2>
<ul>
<li>
<p>Set up <a href=https://notmuchmail.org/doc/latest/notmuch-emacs.html#saved-searches>saved searches</a>.</p>
</li>
<li>
<p>Prevent wrapping text at 70 characters while composing an email:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>;; This is valid in doom emacs. You may need to customize for other distributions.
;; Prevent wrapping at 70 characters in email composition.
(add-hook! &#39;message-mode-hook &#39;turn-off-auto-fill)
(add-hook! &#39;message-mode-hook &#39;visual-line-mode)
</code></pre></div></li>
</ul>
<h2 id=done>Done!<a hidden class=anchor aria-hidden=true href=#done>¶</a></h2>
<p>For those of you using <a href=https://github.com/hlissner/doom-emacs><code>doom emacs</code></a>, you can open notmuch from anywhere with <code>SPC o m</code>.</p>
<div class=bl-section>
<hr>
<h4>Backlinks</h4>
<div class=backlinks>
<ul>
<li><a href=/posts/8f61e9e6-4f19-4a64-b392-185062df45a0/>Email in Emacs</a></li>
</ul>
</div>
</div>
</div>
<footer class=post-footer>
<script>var nextUntil=function(a,d,b){var c=[];for(a=a.nextElementSibling;a;){if(a.matches(d))break;if(b&&!a.matches(b)){a=a.nextElementSibling;continue}c.push(a),a=a.nextElementSibling}return c};const flashcardHeader=document.getElementById("flashcards");if(flashcardHeader){const e=nextUntil(flashcardHeader,"h2"),a=document.createElement('div');a.setAttribute('class','toc');const b=document.createElement('details');a.appendChild(b);const d=document.createElement('summary');b.appendChild(d);const c=document.createElement('div');c.setAttribute('class','inner'),b.appendChild(c),nextUntil(flashcardHeader,"h2").forEach(a=>{c.appendChild(a)}),flashcardHeader.parentNode.insertBefore(document.createElement('hr'),flashcardHeader),flashcardHeader.parentNode.insertBefore(a,flashcardHeader),d.appendChild(flashcardHeader)}</script>
<script src=/js/citations/custom.js></script>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=http://cashpw.com/>Cash Prokop-Weaver</a></span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a>
</span>
<span style=display:inline-block;margin-left:1em>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>(function(){const b=''=='1';if(b)return;let a=document.getElementById("theme-toggle");a.removeEventListener('click',toggleThemeListener),a.addEventListener('click',toggleThemeListener)})()</script>
<script>(function(){let a=document.getElementById('menu');a&&(a.scrollLeft=localStorage.getItem("menu-scroll-position"),a.onscroll=function(){localStorage.setItem("menu-scroll-position",a.scrollLeft)});const b=''=='1',c=''=='1';if(window.matchMedia('(prefers-reduced-motion: reduce)').matches||b||c)return;document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})})()</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>if(window.scrollListeners)for(const a of scrollListeners)window.removeEventListener('scroll',a);window.scrollListeners=[]</script>
<script src=/js/medium-zoom.min.js data-no-instant></script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
<script>(function(){const h='1'=='1';if(!h)return;if(!document.querySelector('.toc')){console.log('no toc found, ignore toc scroll');return}const i=window.scrollListeners,c=document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id]'),d='active';let a=c[0];e(a).classList.add(d);const g=()=>{const b=[];for(const a of c)if(j(a)<5)b.push(a);else break;b.length>0?newActiveHeading=b[b.length-1]:newActiveHeading=c[0],a!=newActiveHeading&&(e(a).classList.remove(d),a=newActiveHeading,e(a).classList.add(d))};let b=null;const f=()=>{b!==null&&clearTimeout(b),b=setTimeout(g,50)};window.addEventListener('scroll',f,!1),i.push(f);function e(a){const b=encodeURI(a.getAttribute('id')).toLowerCase();return document.querySelector(`.toc ul li a[href="#${b}"]`)}function j(a){if(!a.getClientRects().length)return 0;let b=a.getBoundingClientRect();return b.top}})()</script>
</body>
</html>